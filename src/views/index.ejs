<!doctype html>
<html lang="en">

<%- include('global/header', {names: names}) %>

<head>
  <meta charset="utf-8" />
  <title>Crimes by County</title>
  <meta name="author" content="You">
  <meta name="description" content="Crimes by county in New York State">
  <meta content="text/html" http-equiv="Content-type" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js" integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="styles.css">
  <link href="/path/to/c3.css" rel="stylesheet">
  <script src="/path/to/d3.v5.min.js" charset="utf-8"></script>
  <script src="/path/to/c3.min.js"></script>
  <script src="https://cdn.plot.ly/plotly-2.16.1.min.js"></script>
  <script src="plotly-2.16.1.min.js"></script>

  <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.js"></script>
  <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v1.2.0/mapbox-gl.css" rel="stylesheet" />
  <script src="./citysdk.js"></script>

</head>

<body>
  <header>
    <h1>Crimes by County in the last 5 years</h1>
  </header>
  <section id="county-table">
    <table>
      <tr>
        <th>County</th>
        <th>Index Total</th>
        <th>Violent Total</th>
        <th>Property Total</th>
      </tr>
      <% for(county in data){ %>
      <tr>
        <td><a href="<%=data[county].link%>.html"><%= county %></a></td>
        <td><%= data[county]['indexTotal'] %></td>
        <td><%= data[county]['violentTotal'] %></td>
        <td><%= data[county]['propertyTotal'] %></td>
      </tr>
      <%}%>
    </table>
  </section>

  <section>
    <div id="map" style="width:100%; max-width:700px"></div>
<script>

let dataArr = [];

<%for (county in data){%>
      dataArr.push(<%=data[county]["indexTotal"]%>);
      <%}%>
//console.log(dataArr);


var data = [{
  type: "choroplethmapbox",
  geojson: "counties.GeoJSON",
  //geojson: "https://raw.githubusercontent.com/plotly/datasets/master/geojson-counties-fips.json",
  locations: ["Hamilton County", "Chenango County", "Livingston County", "Schuyler County", "Schoharie County", "Rensselaer County", "Oneida County", "Wayne County", "Suffolk County", "Tioga County", "Rockland County", "Wyoming County", "Oswego County", "Orleans County", "Steuben County", "Washington County", "St. Lawrence County", "Warren County", "Westchester County",
    "Tompkins County", "Otsego County", "Chautauqua County", "Seneca County", "Cayuga County", "Queens County", "Essex County", "Ulster County", "Sullivan County", "Chemung County", "New York County", "Monroe County", "Nassau County", "Onondaga County", "Columbia County", "Dutchess County", "Schenectady County", "Saratoga County", "Greene County", "Ontario County",
    "Delaware County", "Allegany County", "Albany County", "Bronx County", "Broome County", "Clinton County", "Erie County", "Jefferson County", "Fulton County", "Madison County", "Kings County", "Genesee County", "Lewis County", "Franklin County", "Montgomery County", "Orange County", "Yates County", "Cortland County", "Richmond County", "Cattaraugus County",
    "Herkimer County", "Niagara County", "Putnam County"],
  z: dataArr,
  zmin: 0,
  zmax: 200000,
  colorbar: {y: 0, yanchor: "bottom", title: {text:"Crime rates in NY counties"}}
}];

var layout = {mapbox: {center: {lon: -76, lat: 42}, zoom: 4.6},
              width: 600, height:400};

var config = {mapboxAccessToken: "pk.eyJ1Ijoibmlja3JvYmIiLCJhIjoiY2xiNGdxaXMxMDY0ODNvbWtob2s4eTljMSJ9.Rq3u5EkXTlspNVbucQIdcQ"};

Plotly.newPlot('map', data, layout, config);

</script>
  </section>

  <%- include ('global/footer');  %>

</body>

</html>
